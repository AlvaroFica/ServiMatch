{% extends 'admin/base_admin.html' %}
{% block title %}Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}
{% block content %}
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.5rem">
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Total Usuarios</h3>
      <p id="totalUsuarios" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
    </div>
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Total Trabajadores</h3>
      <p id="totalTrabajadores" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
    </div>
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Pendientes Verificar</h3>
      <p id="trabajadoresPendientes" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
      <a href="{% url 'admin_pendientes' %}"
         style="display:inline-block;margin-top:.5rem;padding:.5rem 1rem;
                background:#2980b9;color:#fff;border-radius:6px;text-decoration:none">
        Ver pendientes
      </a>
    </div>
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Usuarios en Línea</h3>
      <p id="usuariosOnline" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
    </div>
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Total Servicios</h3>
      <p id="totalServicios" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
    </div>
    <div style="background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)">
      <h3>Citas este Mes</h3>
      <p id="citasMes" style="font-size:2.5rem;color:#2980b9;font-weight:700">–</p>
    </div>
  </div>
  <script>
    const API = 'http://127.0.0.1:8000/api';
    async function setStat(path,id){
      try{
        let r=await fetch(API+path), j=await r.json();
        document.getElementById(id).textContent=j.total;
      }catch{
        document.getElementById(id).textContent='–';
      }
    }
    setStat('/graficos/total-usuarios/','totalUsuarios');
    setStat('/graficos/total-trabajadores/','totalTrabajadores');
    setStat('/graficos/trabajadores-pendientes/','trabajadoresPendientes');
    setStat('/graficos/usuarios-online/','usuariosOnline');
    setStat('/graficos/total-servicios/','totalServicios');
    setStat('/graficos/citas-este-mes/','citasMes');
  </script>
{% endblock %}
