{% extends 'admin/base_admin.html' %}
{% block title %}Pendientes{% endblock %}
{% block page_title %}Pendientes Verificar{% endblock %}
{% block content %}
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1.5rem">
    {% for t in trabajadores %}
      <div style="background:#fff;padding:1.5rem;border-radius:12px;
                  box-shadow:0 4px 8px rgba(0,0,0,0.1);text-align:center">
        <h3>{{ t.usuario.nombre }} {{ t.usuario.apellido }}</h3>
        <div style="display:flex;justify-content:center;gap:1rem;margin:1rem 0">
          <div>
            <small>Cédula Frente</small><br>
            <img src="{{ t.foto_cedula }}" style="width:100px;height:100px;object-fit:cover;border-radius:8px">
          </div>
          <div>
            <small>Cédula Dorso</small><br>
            <img src="{{ t.foto_cedula_atras }}" style="width:100px;height:100px;object-fit:cover;border-radius:8px">
          </div>
          <div>
            <small>Selfie</small><br>
            <img src="{{ t.foto_autoretrato }}" style="width:100px;height:100px;object-fit:cover;border-radius:8px">
          </div>
        </div>
        <button data-id="{{ t.id }}" style="margin:.5rem;padding:.6rem 1rem;
                background:#27ae60;color:#fff;border:none;border-radius:8px;cursor:pointer"
                onclick="patch({{ t.id }},true)">✅ Verificar</button>
        <button data-id="{{ t.id }}" style="margin:.5rem;padding:.6rem 1rem;
                background:#c0392b;color:#fff;border:none;border-radius:8px;cursor:pointer"
                onclick="patch({{ t.id }},false)">❌ Rechazar</button>
      </div>
    {% empty %}
      <p>No hay pendientes.</p>
    {% endfor %}
  </div>
  <script>
    async function patch(id,ver){
      const r=await fetch(`http://127.0.0.1:8000/api/trabajadores/${id}/`,{
        method:'PATCH',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({estado_verificado:ver})
      });
      if(r.ok)location.reload();
    }
  </script>
{% endblock %}
